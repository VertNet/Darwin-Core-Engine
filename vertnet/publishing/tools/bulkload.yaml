# Configuration for bulkloding Record and RecordIndex to App Engine datastore.

python_preamble:
- import: base64
- import: re
- import: google.appengine.ext.bulkload.transform
- import: google.appengine.ext.bulkload.bulkloader_wizard
- import: google.appengine.ext.db
- import: google.appengine.api.datastore
- import: google.appengine.api.users
- import: bulkload_helper
- import: ndb

transformers:

- kind: Record
  connector: csv
  connector_options:
    encoding: utf_8
  
  property_map:
    - property: __key__
      external_name: reckey
      import_transform: bulkload_helper.create_record_key()  

    - property: json
      external_name: recjson
      import_transform: transform.none_if_empty(db.Text)
      
- kind: RecordIndex
  connector: csv
  connector_options:
    encoding: utf_8
  
  property_map:
    - property: __key__
      external_name: reckey
      import_transform: bulkload_helper.create_record_index_key()
                            
    - property: corpus
      external_name: recjson
      import_transform: bulkload_helper.get_corpus_list()
